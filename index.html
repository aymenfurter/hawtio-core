<!DOCTYPE html>
<html class="layout-pf layout-pf-fixed">
  <head>
    <title>hawtio</title>
    <base href='/'>
    <meta charset="UTF8">

    <!-- CSS -->
    <!-- patternfly -->
    <link rel="stylesheet" href="node_modules/patternfly/dist/css/patternfly.min.css">
    <link rel="stylesheet" href="node_modules/patternfly/dist/css/patternfly-additions.min.css">
    <!-- hawtio -->
    <link rel="stylesheet" href="dist/hawtio-core.css">
    
    <!-- JAVASCRIPT -->
    <!-- jquery -->
    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <!-- bootstrap -->
    <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <!-- patternfly -->
    <script src="node_modules/patternfly/dist/js/patternfly.min.js"></script>
    <!-- angular -->
    <script src="node_modules/angular/angular.js"></script>
    <!-- angular-sanitize -->
    <script src="node_modules/angular-sanitize/angular-sanitize.js"></script>
    <!-- angular-route -->
    <script src="node_modules/angular-route/angular-route.min.js"></script>
    <!-- lodash -->
    <script src="node_modules/lodash/lodash.min.js"></script>
    <!-- urijs -->
    <script src="node_modules/urijs/src/URI.min.js"></script>
    <!-- js-logger -->
    <script src="node_modules/js-logger/src/logger.min.js"></script>
    <!-- @hawtio/core -->
    <script src="dist/hawtio-core.js"></script>
    <!-- navigation example -->
    <script src="example/navigation-example.js"></script>
  </head>
  <body>
    <nav class="navbar navbar-pf-vertical">
      <div class="navbar-header">
        <a href="/" class="navbar-brand">
          <hawtio-branding-image class="navbar-brand-name" src="logoUrl" alt="appName"></hawtio-branding-image>
        </a>
      </div>
      <nav class="collapse navbar-collapse">
        <ul class="nav navbar-nav navbar-right navbar-iconic">
          <li class="dropdown">
            <a class="dropdown-toggle nav-item-iconic" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
              <span title="Username" class="fa pficon-user"></span>
              <span class="caret"></span>
            </a>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenu1" hawtio-extension name="hawtio-user">
            </ul>
          </li>
        </ul>
      </nav>
    </nav>
  
    <hawtio-vertical-nav></hawtio-vertical-nav>

    <div id="main" class="container-fluid container-pf-nav-pf-vertical ng-cloak"
         ng-controller="HawtioNav.ViewController"
         ng-include src="viewPartial">
    </div>

    <script>
      var log = Logger.get('test-code');
      log.setLevel(Logger.DEBUG);
      
      // Simple task that's just a function, no name, no dependencies
      hawtioPluginLoader.registerPreBootstrapTask(function(next) {
        next();
      });
      
      // A task that requires some other task to run first
      hawtioPluginLoader.registerPreBootstrapTask({
        name: "AsyncDependantTask",
        depends: ["AsyncTask"],
        task: function(next) {
          console.log("async task ran...");
          next();
        }
      });
      
      // setBootstrapElement can be used to change what element will be passed to angular.bootstrap
      hawtioPluginLoader.registerPreBootstrapTask({
        name: "ChangeBootstrapEl",
        task: function(next) {
          hawtioPluginLoader.setBootstrapElement(document.body);
          next();
        }
      });
      
      // another simple task, does nothing, not sure why there's a duplicate here :-)
      hawtioPluginLoader.registerPreBootstrapTask(function(next) {
        next();
      }, true);
      
      // Another dependent task, this one is async, the task list continues once the timeout completes
      hawtioPluginLoader.registerPreBootstrapTask({
        name: "AsyncTask",
        depends: ["ParentTask1"],
        task: function(next) {
          console.log("Async task loading");
          setTimeout(function() {
            console.log("Async task executing");
            next();
          }, 5000);
          console.log("Async task exiting");
        }
      });
      
      // Task that depends on a couple other tasks
      hawtioPluginLoader.registerPreBootstrapTask({
        name: 'other-child',
        depends: ['child-task', 'unnamed-task-2'],
        task: function(next) {
          next();
        }
      });
      
      // Task that depends on another task that isn't actually defined, winds up being orphaned and not executed
      hawtioPluginLoader.registerPreBootstrapTask({
        name: "Bunk Task 1",
        depends: ['pastry'],
        task: function(next) {
          next();
        }
      });
      hawtioPluginLoader.registerPreBootstrapTask({
        name: "child-task",
        depends: ["ParentTask1"],
        task: function(next) {
          next();
        }
      });
      hawtioPluginLoader.registerPreBootstrapTask({
        name: "Named Task",
        task: function(next) {
          next();
        }
      });
      hawtioPluginLoader.registerPreBootstrapTask({
        name: "ParentTask1",
        task: function(next) {
          next();
        }
      });
      // these won't get executed, they depend on tasks that
      // haven't been registered
      hawtioPluginLoader.registerPreBootstrapTask({
        name: "Bunk Task 2",
        depends: ['foo', 'bar'],
        task: function(next) {
          next();
        }
      });

    </script>
  </body>
</html>
